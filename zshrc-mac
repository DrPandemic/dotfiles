source ~/.zprofile

# User configuration
export TERM='screen-256color'

alias htop TERM=screen htop
alias gclean='git branch --merged main | grep -v "\* main" | grep -v ".*main" | xargs -n 1 git branch -d'
#alias ping=prettyping

alias devdus='dev down && dev up && dev s'
alias devdut='dev down && dev up && dev t'
alias devdu='dev down && dev up'
alias devus='dev up && dev s'
alias devut='dev up && devt'
alias devst='dev style --include-branch-commits --all-cops'
alias devt='dev t --include-branch-commits '
alias devs='dev s'
alias devu='dev u'
alias devd='dev d'
alias devc='dev c'
alias devuc='dev u && dev c'
alias devduc='dev d && dev u && dev c'
alias devv='dev typecheck && dev style --include-branch-commits && devt'
alias devuv='devu && devv'
alias devuv='devdu && devv'
alias chrome="/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome"
alias t="dev test"

export EDITOR='vim'
export CC=clang
export CXX=clang++

if [[ -z $TMUX ]]; then
  tmux a || tmux
fi

function devdomain() {
  echo "s = OpenSrsDomainSubscription.create!(host: '$1', shop: Shop.first); DomainHandler.create!(host: \"www.#{s.host}\", shop: s.shop, subscription: s); DomainHandler.create!(host: s.host, shop: s.shop, subscription: s); s.update(status: 'registered')" | dev console
}

function :q() {
  exit
}

function pvm() {
  unset -f pvm
  source ~/Projects/pvm/init-pvm.sh
  pvm "$@"
}

function sed_regex() {
  rg -l "$1" | xargs sed -i '' -e 's|'$1'|'$2'|g'
}

# Theme
source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"

function dev {
  unset -f dev
  [ -f /opt/dev/dev.sh ] && source /opt/dev/dev.sh
  dev "$@"
}

bindkey -v
bindkey fd vi-cmd-mode
# Timeout after escape
export KEYTIMEOUT=1
bindkey '^E' end-of-line
bindkey '^A' beginning-of-line

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

eval "$(shadowenv init zsh)"

[[ -f /opt/dev/sh/chruby/chruby.sh ]] && type chruby >/dev/null 2>&1 || chruby () { source /opt/dev/sh/chruby/chruby.sh; chruby "$@"; }

# Don't save commands starting with a space
setopt HIST_IGNORE_SPACE

[[ -x /usr/local/bin/brew ]] && eval $(/usr/local/bin/brew shellenv)
